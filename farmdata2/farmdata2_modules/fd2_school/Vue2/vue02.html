<div id="report" v-cloak>
    <h1>Harvest Report</h1>
    <p>This page is a <i>mockup</i> of a simplified harvest report</p>
    <form>
        <div>
            <label for="title">Title: </label>
            <input type="text" id="title" name="title" placeholder="" v-model="reportTitle"/>
        </div>
        <br>
        <div>
            <label for="start">Start: </label>
            <input type="date" id="start" name="start-date" min="2014-01-01"
            max="2022-01-01" v-model="reportStartDate"/>

            <label for="end">End: </label>
            <input type="date" id="end" name="end-date" min="2020-05-05"
            max="2022-01-01" v-model="reportEndDate"/>
        </div>
        <br>
        <div>
            <label for="crop">Crop: </label>
            <select name="crop" id="crop" v-model="reportCrop">
                <option v-for="crop in crops" :value="crop">{{crop}}</option>
            </select>

            <label for="area">Area: </label>
            <select name="area" id="crop">
                <option v-for="area in areas" :value="area">{{area}}</option>
            </select>
        </div>
        <br>
    </form>
    <button @click="logHarvest(); changeReportState('show')">Generate Report</button>
    

    <hr>

    <div id="reportDetail" v-if="reportState !== 'default'">
        <h1>{{reportTitle ? reportTitle : 'Mock Harvest Report'}}</h1>
        <div>Details:</div>
        <ul>
            <li><b>Farm</b>:Sample Farm</li>
            <li><b>User</b>:worker1</li>
            <li><b>Language</b>:English</li>
            <br>
            <li><b>Start</b>:{{reportStartDate}}</li>
            <li><b>End</b>:{{reportEndDate}}</li>
            <li><b>Crop</b>:{{reportCrop}}</li>
        </ul>
        <br>
        <table border="1">
            <tr v-if="harvestLogs.length >= 0">
                <th>Row</th>
                <th>Date</th>
                <th>Area</th>
                <th>Crop</th>
                <th>Yield</th>
                <th>Units</th>
                <th>Delete</th>
            </tr>
            <p v-else>There are no matching records</p>
    
            <tr v-for="(harvestLog, index) in harvestLogs">
                <td>{{index + 1}}</td>
                <td>{{harvestLog.date}}</td>
                <td>{{harvestLog.area}}</td>
                <td>{{harvestLog.crop}}</td>
                <td>{{harvestLog.yield}}</td>
                <td>{{harvestLog.units}}</td>
                <td><button v-on:click="deleteHarvest">Delete</button></td>
            </tr>
        </table>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/vue@2"></script>

<script>
    const report = new Vue({
        el: "#report",
        data: {
            reportState: 'default',
            reportTitle: "",
            reportStartDate: "",
            reportEndDate: "",
            reportCrop: "",
            crops: [
                "Broccoli",
                "Kale",
                "Peas",
            ],
            areas: [
                "All",
                "Chuau-1",
                "SQ7",
            ],
            harvestLogs: [],
        },
        methods: {
            logHarvest: function() {
                if (this.reportState !== 'default') {
                    if (this.harvestLogs.length === 0) {
                        this.harvestLogs.push({date: '2018-05-01', area: 'Orion-3', crop: 'Kale', yield: '12', units: 'Bunches'})
                    } else if (this.harvestLogs.length === 1) {
                        this.harvestLogs.push({date: '2020-03-02', area: 'Chuau-1', crop: 'Broccoli', yield: '6', units: 'Bunches'})
                    } else if (this.harvestLogs.length === 2) {
                        this.harvestLogs.push({date: '2019-04-21', area: 'Orion-2', crop: 'Cabbage', yield: '18', units: 'Bunches'})
                    }
                }
            },
            deleteHarvest: function(harvestIndex) {
                this.harvestLogs.splice(harvestIndex, 1)
            },
            changeReportState: function(newState) {
                this.reportState = newState
            }
        }
    }) 
    Vue.config.devtools = true
</script>